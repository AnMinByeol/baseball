<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/style.css" rel="stylesheet">
<link href="/css/cheer.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Dosis:200,300,400,500,600,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto:200,300,400,500,600,700" rel="stylesheet">
<link rel="stylesheet" href="/css/style_twinbears.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
   $(function() {
     $('#header').load('./bears_header');
     $('#footer').load('./bears_footer');
   });
</script>

<style>
  
.table-bordered td {
      width: 120px;
      height: 110px;
    }
.table-bordered th {
  text-align: center;
}

#month-year {
  text-align: center;
}

.container3 {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  position: relative;
  top: -130px; /* 원하는 만큼의 픽셀만큼 위로 이동 */
}

.table-bordered td:nth-child(7) {
    color: black;
  }

  .table-bordered th:nth-child(7) {
    color: blue;
  }

  .table-bordered td:nth-child(1) {
    color: black;
  }

  .table-bordered th:nth-child(1) {
    color: red;
  }

h2#month-year {
  font-size: 24px;
  font-weight: bold;
  text-align: center;
  margin: 10px 0;
  color: #333;
  text-transform: uppercase;
}



</style>
</head>
<div id="header"></div>
<body>

<!-- CONTENT =============================-->
<div class="container toparea">
  <div class="underlined-title">
     <div class="editContent">
        <h1 class="text-center latestitems"></h1>

        </div>
     <div class="wow-hr type_short">
        
     </div>
  </div>
<div class="container3">
  <div class="row">
     
     <div>
        <!-- Calendar View -->
        <div id="calendar">
          
          <h2 id="month-year"></h2>
           <table class="table table-bordered" style="margin-top:200px;">
              <thead>
                 <tr>
                    <th>SUN</th>
                    <th>MON</th>
                    <th>TUE</th>
                    <th>WED</th>
                    <th>THU</th>
                    <th>FRI</th>
                    <th>SAT</th>
                 </tr>
              </thead>
              <tbody id="calendar-body">
                 <!-- Calendar content -->
              </tbody>
           </table>
           <div class="text-center">
              <button id="previous-month">◁</button>
              <button id="next-month">▷</button>
           </div>
        </div>
     </div>
  </div>
</div>

<table>
  <tr>
      <th>Date</th>
      <th>Team Left</th>
      <th>Team Right</th>
      <th>Time</th>
  </tr>
  <tr th:each="calendar : ${data}">
      <td><span th:text="${calendar.date}"></span></td>
      <td><span th:text="${calendar.team_lft}"></span></td>
      <td><span th:text="${calendar.team_rgt}"></span></td>
      <td><span th:text="${calendar.time}"></span></td>
  </tr>
</table>
<!-- FOOTER =============================-->
<div id="footer"></div>
<!-- Load JS here for greater good =============================-->
<script src="/js/jquery-.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/anim.js"></script>
<script>
//----호버 캡션---//
jQuery(document).ready(function ($) {
$('.fadeshop').hover(
function(){
$(this).find('.captionshop').fadeIn(150);
},
function(){
$(this).find('.captionshop').fadeOut(150);
}
);
});


var container3 = document.querySelector('.container3');
container3.style.position = 'relative';
container3.style.top = '-100px'; /* 원하는 만큼의 픽셀만큼 위로 이동 */

// 캘린더 요소 가져오기
const calendarBody = document.getElementById('calendar-body');
const monthYear = document.getElementById('month-year');
const previousMonthBtn = document.getElementById('previous-month');
const nextMonthBtn = document.getElementById('next-month');

 //예슬누나 여기
// 현재 페이지의 URL에서 쿼리 매개변수를 가져오는 URLSearchParams 객체를 생성
const urlParams = new URLSearchParams(window.location.search);

// 'month'라는 이름의 쿼리 매개변수 값을 가져옴
const monthParam = urlParams.get('month');

// '두산'이라는 이름의 쿼리 매개변수 값을 가져옴

const teamParam = urlParams.get('team') ?? 'OB';
////////////////////////////////////////////////////////////////////////////////

let currentDate;
if (monthParam && teamParam) {
  currentDate = new Date(2023, parseInt(monthParam) - 1);
} else {
  currentDate = new Date(2023, 6); // 2023년 7월
}

// 달력 데이터 배열
const calendarData = [
  {
    year: 2023,
    month: 5,
    days: [
     
      // 6월의 이벤트 데이터를 추가로 작성
    ]
  },
  {
    year: 2023,
    month: 6,
    days: [
      

    
      // 7월의 이벤트 데이터를 작성
    ]
  }
];

renderCalendar(currentDate);

// 이전 달과 다음 달 버튼에 이벤트 리스너 추가
previousMonthBtn.addEventListener('click', () => {
  currentDate.setMonth(currentDate.getMonth() - 1);
  updateURL(currentDate.getMonth() + 1, teamParam);
  renderCalendar(currentDate);
});

nextMonthBtn.addEventListener('click', () => {
  currentDate.setMonth(currentDate.getMonth() + 1);
  updateURL(currentDate.getMonth() + 1, teamParam);
  renderCalendar(currentDate);
});

// 캘린더를 렌더링하는 함수
function renderCalendar(date) {
  // 이전 캘린더 내용 지우기
  calendarBody.innerHTML = '';

  // 월과 년도 헤딩 업데이트
  const options = { year: 'numeric', month: 'long' };
  monthYear.textContent = date.toLocaleDateString('ko-KR', options);

  // 현재 달의 날짜 수 계산
  const year = date.getFullYear();
  const month = date.getMonth();
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  // 현재 달의 첫 번째 날짜 인덱스 계산
  const firstDayIndex = new Date(year, month, 1).getDay();

  // 해당 월에 대한 데이터 가져오기
  const monthData = calendarData.find(
    data => data.month === month && data.year === year
  );

  if (!monthData) {
    // 데이터가 없을 경우 처리
    return;
  }

  // 캘린더 셀 생성
  let day = 1;
  for (let i = 0; i < 6; i++) {
    const row = document.createElement('tr');
    for (let j = 0; j < 7; j++) {
      if (i === 0 && j < firstDayIndex) {
        // 현재 달의 첫 번째 날짜 이전의 빈 셀
        const cell = document.createElement('td');
        row.appendChild(cell);
      } else if (day > daysInMonth) {
        // 현재 달의 마지막 날짜 이후의 빈 셀
        break;
      } else {
        // 해당 날짜가 표시된 캘린더 셀
        const cell = document.createElement('td');
        const dayData = monthData.days.find(d => d.date === day);
        cell.textContent = day;
        if (dayData) {
          // 해당 날짜의 이벤트 데이터가 있는 경우
          const content = document.createElement('div');
          content.textContent = dayData.content;
          cell.appendChild(content);
        }
        row.appendChild(cell);
        day++;
      }
    }

    calendarBody.appendChild(row);
  }
}



// URL 업데이트 함수 //예슬 누나 여기
function updateURL(month, team) {
  // URLSearchParams 객체를 생성
  const params = new URLSearchParams();

  // month 매개변수를 쿼리 매개변수로 설정
  params.set('month', month);

  // team 매개변수를 쿼리 매개변수로 설정
  params.set('team', team);

  // 현재 URL의 경로와 설정된 쿼리 매개변수를 문자열로 변환하여 새로운 URL을 생성
  const newURL = window.location.pathname + '?' + params.toString();

  // 새로운 URL로 브라우저의 URL을 업데이트
  window.history.replaceState({}, '', newURL);
}


 //현재 페이지의 URL을 가져와 currenturl 변수에 저장
 window.onload = function() {
  const currentURL = window.location.href; //현재 페이지의 URL을 currenturl 변수에 저장
  const currentDate = new Date(); //현재 날짜와 시간을 나타내는 date 객체를 생성
  const currentMonth = currentDate.getMonth() + 1;

  // 현재 URL이 원하는 주소와 다를 경우에만 리다이렉션
  if (currentURL !== `://localhoshttpt:8080/bears/Calendar.do?month=${currentMonth}&team=OB`) {
    window.history.replaceState({}, '', `/bears/Calendar.do?month=${currentMonth}&team=OB`); // 현재 url을 원하는 주소로 변경
  }
};

</script>
</body>
</html>



